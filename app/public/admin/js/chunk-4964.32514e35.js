(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4964"],{"31Ud":function(t,e,o){"use strict";var s=o("H4nY");o.n(s).a},H30g:function(t,e,o){"use strict";var s=o("wCVM");o.n(s).a},H4nY:function(t,e,o){},P14b:function(t,e,o){"use strict";o.d(e,"a",function(){return a});var s=o("t3Un");function a(t,e){var o=new FormData;return o.append("file",e,t),Object(s.a)({url:"/upload/image",method:"post",headers:{"Content-Type":"multipart/form-data"},data:o})}},YilU:function(t,e,o){"use strict";var s=o("cLjf"),a=o.n(s),r=o("hDQ3"),n=o.n(r),i=o("6ZY3"),l=o.n(i),c=o("Y/SO"),u=o("Grqa"),p=o("uARZ"),m=o("xA6U"),d=o("ZAAW"),f=o("Hy6Q"),g={name:"CroppaList",components:{Croppa:f.a},props:{value:{type:Array,default:""},height:{type:Number,required:!1,default:240},width:{type:Number,required:!1,default:240},quality:{type:Number,required:!1,default:1}},data:function(){return{hasChange:!1,hasInit:!1,list:[{url:"",name:""}],uploadList:[]}},watch:{value:function(t){this.hasChange||this.hasInit||(Array.isArray(t)&&t.length>0&&(this.list=t.concat([{url:"",name:""}]),this.uploadList=this.uploadList.concat(t)),this.hasInit=!0)}},methods:{onSelect:function(t){this.list.push({url:"",name:""})},onRemove:function(t){this.hasChange=!0,this.list.splice(t,1),this.uploadList.splice(t,1),this.$emit("input",this.uploadList)},onUpload:function(t){this.hasChange=!0,this.uploadList.push(t),this.$emit("input",this.uploadList)}}},h=(o("31Ud"),o("ZrdR")),b=Object(h.a)(g,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ul",{staticClass:"upload-list"},t._l(t.list,function(e,s){return o("li",[o("Croppa",{attrs:{index:s,width:t.width,height:t.height,isShowUpload:!0,quality:t.quality},on:{onSelect:t.onSelect,onRemove:t.onRemove,onUpload:t.onUpload},model:{value:e.url,callback:function(o){t.$set(e,"url",o)},expression:"item.url"}})],1)}))},[],!1,null,"20224554",null);b.options.__file="index.vue";var v=b.exports,_=(o("X4fA"),{goodsID:"",title:"",subTitle:"",note:"",name:"",goodsType:"",imgurl:"",price:0,priceMarket:0,stock:500,goodsStatus:"0",sortNo:0,goodsImages:[],goodsClassID:"",recommendFlag:!1,comment_disabled:!1}),F=[{key:"E",display_name:"实物"},{key:"V",display_name:"虚拟商品"}],y=[{key:"0",display_name:"新建"},{key:"D",display_name:"下架"},{key:"U",display_name:"上架"},{key:"C",display_name:"删除"}],k={name:"productDetail",components:{Ueditor:c.a,MDinput:u.a,Croppa:f.a,Sticky:p.a,CroppaList:v},props:{isEdit:{type:Boolean,default:!1},goods_id:""},data:function(){return{dialogImageUrl:"",dialogVisible:!1,calendarTypeOptions:F,calendargoodsStatusOptions:y,postForm:l()({},_),fetchSuccess:!0,loading:!1,gooddsClass_options:[],rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],name:[{required:!0,message:"请输入商品名",trigger:"blur"}],goodsType:[{required:!0,message:"请选择类型",trigger:"blur"}],price:[{type:"number",required:!0,message:"请输入价格",trigger:"blur"}],priceMarket:[{type:"number",required:!0,message:"请输入市场价",trigger:"blur"}],goodsStatus:[{required:!0,message:"请选择状态",trigger:"blur"}],goodsClassID:[{required:!0,message:"请选择分类",trigger:"blur"}]}}},computed:{contentShortLength:function(){return this.postForm.name.length}},created:function(){this.initData(),this.isEdit?this.fetchData():(this.postForm=l()({opBy:this.$store.state.user.name},_),this.postForm.goodsImages=[])},methods:{initData:function(){var t=this;Object(d.c)("shop_goodsClass",{where:"status !='C' and parentID=0",page:1,limit:100}).then(function(e){t.gooddsClass_options=e.result})},resetForm:function(t){this.$refs[t].resetFields(),this.$refs.imgurl.clear(),this.$refs.editor.setContent(""),this.postForm.goodsImages=[]},fetchData:function(){var t=this;Object(m.a)(this.goods_id).then(function(e){t.postForm=e.result}).catch(function(e){t.fetchSuccess=!1,console.log(e)})},saveData:function(){var t=this;return n()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.imgurl.upload();case 2:e.sent&&t.$refs.postForm.validate(function(e){e?(t.loading=!0,Object(m.d)(t.postForm).then(function(e){t.fetchSuccess=!0,t.$notify({title:"成功",message:"商品发布成功",type:"success",duration:2e3}),t.isEdit||t.resetForm("postForm"),t.loading=!1}).catch(function(t){console.log(t)})):console.log("error submit!!")});case 4:case"end":return e.stop()}},e,t)}))()},submitForm:function(){var t=this;"U"==this.postForm.goodsStatus?this.$confirm("当前商品为上架状态，您确定要发布吗？","提示").then(function(){t.saveData()}):this.saveData()}}},C=(o("H30g"),Object(h.a)(k,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{"status-icon":"",model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{className:"sub-navbar "+t.postForm.status}},[t.fetchSuccess?[o("el-dropdown",{attrs:{trigger:"click"}},[o("el-button",[t._v(t._s(t.postForm.comment_disabled?"评论已关闭":"评论已打开")+"\n            "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-padding",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",[o("el-radio-group",{staticStyle:{padding:"10px"},model:{value:t.postForm.comment_disabled,callback:function(e){t.$set(t.postForm,"comment_disabled",e)},expression:"postForm.comment_disabled"}},[o("el-radio",{attrs:{label:!0}},[t._v("关闭评论")]),t._v(" "),o("el-radio",{attrs:{label:!1}},[t._v("打开评论")])],1)],1)],1)],1),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(e){t.submitForm()}}},[t._v("发布\n        ")]),t._v(" "),o("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){t.resetForm("postForm")}}},[t._v("重置\n        ")])]:[o("el-tag",[t._v("发送异常错误,刷新页面,或者联系老大")])]],2),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-row",[o("el-col",{attrs:{span:21}},[o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"商品封面(436x360):",prop:"imgurl"}},[o("Croppa",{ref:"imgurl",attrs:{width:218,height:180,quality:2},model:{value:t.postForm.imgurl,callback:function(e){t.$set(t.postForm,"imgurl",e)},expression:"postForm.imgurl"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:15}},[o("el-form-item",{attrs:{prop:"title"}},[o("MDinput",{attrs:{name:"name",required:"",maxlength:64},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v("\n                标题\n              ")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.postForm.title.length>=26,expression:"postForm.title.length>=26"}],staticClass:"title-prompt"},[t._v("APP可能会显示不全")])],1),t._v(" "),o("el-form-item",{attrs:{prop:"subTitle"}},[o("MDinput",{attrs:{name:"name",required:"",maxlength:200},model:{value:t.postForm.subTitle,callback:function(e){t.$set(t.postForm,"subTitle",e)},expression:"postForm.subTitle"}},[t._v("\n                副标题\n              ")])],1),t._v(" "),o("el-form-item",{attrs:{label:"商品名称:",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:t.postForm.name,callback:function(e){t.$set(t.postForm,"name",e)},expression:"postForm.name"}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"字")])],1)],1)],1),t._v(" "),o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"类型:",prop:"goodsType"}},[o("el-select",{staticClass:"filter-item",staticStyle:{"min-width":"200px"},attrs:{clearable:"",placeholder:"类型"},model:{value:t.postForm.goodsType,callback:function(e){t.$set(t.postForm,"goodsType",e)},expression:"postForm.goodsType"}},t._l(t.calendarTypeOptions,function(t){return o("el-option",{key:t.key,attrs:{label:t.display_name,value:t.key}})}))],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"市场价:",prop:"priceMarket"}},[o("el-input-number",{staticStyle:{"min-width":"200px"},attrs:{placeholder:"市场价"},model:{value:t.postForm.priceMarket,callback:function(e){t.$set(t.postForm,"priceMarket",t._n(e))},expression:"postForm.priceMarket"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"销售价:",prop:"price"}},[o("el-input-number",{staticStyle:{"min-width":"200px"},attrs:{placeholder:"销售价"},model:{value:t.postForm.price,callback:function(e){t.$set(t.postForm,"price",t._n(e))},expression:"postForm.price"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"状态:",prop:"goodsStatus"}},[o("el-select",{staticClass:"filter-item",staticStyle:{"min-width":"200px"},attrs:{clearable:"",placeholder:"状态"},model:{value:t.postForm.goodsStatus,callback:function(e){t.$set(t.postForm,"goodsStatus",e)},expression:"postForm.goodsStatus"}},t._l(t.calendargoodsStatusOptions,function(t){return o("el-option",{key:t.key,attrs:{label:t.display_name,value:t.key}})}))],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"分类:",prop:"goodsClassID"}},[o("el-select",{attrs:{placeholder:"分类",clearable:""},model:{value:t.postForm.goodsClassID,callback:function(e){t.$set(t.postForm,"goodsClassID",e)},expression:"postForm.goodsClassID"}},t._l(t.gooddsClass_options,function(t){return o("el-option",{key:t.goodsClassID,attrs:{label:t.name,value:t.goodsClassID}})}))],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"库存:",prop:"stock"}},[o("el-input-number",{staticStyle:{"min-width":"200px"},attrs:{placeholder:"库存"},model:{value:t.postForm.stock,callback:function(e){t.$set(t.postForm,"stock",t._n(e))},expression:"postForm.stock"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"显示顺序:",prop:"sortNo"}},[o("el-input-number",{staticStyle:{"min-width":"200px"},attrs:{placeholder:"显示顺序"},model:{value:t.postForm.sortNo,callback:function(e){t.$set(t.postForm,"sortNo",t._n(e))},expression:"postForm.sortNo"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"推荐:"}},[o("el-checkbox",{staticStyle:{"min-width":"200px"},attrs:{label:"首页",border:""},model:{value:t.postForm.recommendFlag,callback:function(e){t.$set(t.postForm,"recommendFlag",e)},expression:"postForm.recommendFlag"}})],1)],1)],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"editor-container"},[o("Ueditor",{ref:"editor",attrs:{height:400},model:{value:t.postForm.note,callback:function(e){t.$set(t.postForm,"note",e)},expression:"postForm.note"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"轮播图(872x720):"}},[o("CroppaList",{ref:"uploadImages",attrs:{width:218,height:180,quality:4},model:{value:t.postForm.goodsImages,callback:function(e){t.$set(t.postForm,"goodsImages",e)},expression:"postForm.goodsImages"}})],1),t._v(" "),o("el-dialog",{attrs:{visible:t.dialogVisible,size:"tiny"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1)],1)},[],!1,null,"8cbb8132",null));C.options.__file="ProductDetail.vue";e.a=C.exports},ZAAW:function(t,e,o){"use strict";o.d(e,"c",function(){return a}),o.d(e,"e",function(){return r}),o.d(e,"d",function(){return n}),o.d(e,"b",function(){return i}),o.d(e,"a",function(){return l}),o.d(e,"f",function(){return c});var s=o("t3Un");function a(t,e){return Object(s.a)({url:"/model/"+t,method:"get",params:e})}function r(t){return Object(s.a)({url:"/region",method:"get",params:{parent_id:t}})}function n(t,e){return Object(s.a)({url:"/model/"+t+"/"+e,method:"get"})}function i(t,e){return Object(s.a)({url:"/model/"+t+"/"+e,method:"delete"})}function l(t,e){return Object(s.a)({url:"/model/"+t,method:"post",data:e})}function c(t,e,o){return Object(s.a)({url:"/model/"+t+"/"+e,method:"put",data:o})}},jNee:function(t,e,o){"use strict";o.r(e);var s={name:"editProduct",components:{ProductDetail:o("YilU").a}},a=o("ZrdR"),r=Object(a.a)(s,function(){var t=this.$createElement;return(this._self._c||t)("product-detail",{attrs:{"is-edit":!0,goods_id:this.$route.params.goods_id}})},[],!1,null,null,null);r.options.__file="edit.vue";e.default=r.exports},wCVM:function(t,e,o){},xA6U:function(t,e,o){"use strict";o.d(e,"b",function(){return a}),o.d(e,"a",function(){return r}),o.d(e,"d",function(){return n}),o.d(e,"e",function(){return i}),o.d(e,"f",function(){return l}),o.d(e,"c",function(){return c});var s=o("t3Un");function a(t){return Object(s.a)({url:"/goods/list",method:"get",params:t})}function r(t){return Object(s.a)({url:"/goods/"+t,method:"get"})}function n(t){return Object(s.a)({url:"/goods",method:"post",data:t})}function i(t){return Object(s.a)({url:"/goods/status",method:"post",data:t})}function l(t){return Object(s.a)({url:"/goods/recommend",method:"post",data:t})}function c(t){return Object(s.a)({url:"/goods/pv",method:"get",params:{pv:t}})}}}]);